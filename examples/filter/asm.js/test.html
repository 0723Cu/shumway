<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Filters Demo</title>
    <style type="text/css">
      html, body { margin: 0; padding: 0; }
    </style>
  </head>
  <body>

    <div id="canvasContainer">
      <canvas id="canvas"></canvas>
    </div>

    <script src="libs/stats.min.js"></script>
    <script src="libs/dat.gui.min.js"></script>
    <script src="libs/dat.color.min.js"></script>
    <script src="filters.js"></script>
    <script src="demo.js"></script>
    <script>

      window.requestAnimFrame = (function() {
        return  window.requestAnimationFrame ||
                window.webkitRequestAnimationFrame ||
                window.mozRequestAnimationFrame ||
                function(callback) {
                  window.setTimeout(callback, 1000 / 60);
                };
      })();

      (function() {

        var canvas = document.getElementById("canvas");
        var ctx = canvas.getContext("2d");

        var stats = new Stats();
        stats.domElement.style.position = 'absolute';
        stats.domElement.style.left = '0px';
        stats.domElement.style.top = '0px';
        document.body.appendChild(stats.domElement);

        var demo = new Demo(ctx, stats);

        initGui(demo);

        window.addEventListener('resize', function() { demo.dirty = true; }, false);

      })();

      function initGui(demo) {
        var controllers = [];

        var gui = new dat.GUI();
        gui.add(demo, 'shape', ['square']);
        controllers.push(gui);

        var blur = gui.addFolder('blur');
        blur.add(demo, 'blurEnabled');
        blur.add(demo, 'blurQuality', { low: 1, medium: 2, high: 3 });
        blur.add(demo, 'blurX', 0, 64).step(1);
        blur.add(demo, 'blurY', 0, 64).step(1);
        blur.open();
        controllers.push(blur);

        for (var i in controllers) {
          var ctrl = controllers[i];
          for (var j in ctrl.__controllers) {
            ctrl.__controllers[j].onChange(function(value) {
              demo.dirty = true;
            });
          }
        }
      }

    </script>
  </body>
</html>
